Channel,CommandLine,Company,Computer,CreationUtcTime,CurrentDirectory,Description,EventID,EventRecordID,FileVersion,Hashes,Image,IntegrityLevel,Keywords,Level,LogonGuid,LogonId,Message,Opcode,OriginalFileName,ParentCommandLine,ParentImage,ParentProcessGuid,ParentProcessId,ParentUser,ProcessGuid,ProcessID,ProcessId,Product,QueryName,QueryResults,QueryStatus,RenderingInfo,RuleName,SystemTime,TargetFilename,Task,TerminalSessionId,ThreadID,User,UserID,UtcTime,Version,raw
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:39:11.724,,,11,19600,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:39:11.724

ProcessGuid: {f57bd86a-8b6f-658c-e001-000000000f00}

ProcessId: 7104

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_tujhtlz5.vmg.ps1

CreationUtcTime: 2023-12-27 20:39:11.724

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b6f-658c-e001-000000000f00},3588,7104,,,,,"
      ",-,2023-12-27T20:39:11.7335825Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_tujhtlz5.vmg.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:11.724,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:11.7335825Z""/>
      <EventRecordID>19600</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:11.724</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6f-658c-e001-000000000f00}</Data>
      <Data Name=""ProcessId"">7104</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_tujhtlz5.vmg.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:39:11.724</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:39:11.724

ProcessGuid: {f57bd86a-8b6f-658c-e001-000000000f00}

ProcessId: 7104

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_tujhtlz5.vmg.ps1

CreationUtcTime: 2023-12-27 20:39:11.724

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""Spring$((Get-Date).Year)!\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString Spring$((Get-Date).Year)! -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to Spring$((Get-Date).Year)!\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""Spring$((Get-Date).Year)!\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19599,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:11.625

ProcessGuid: {f57bd86a-8b6f-658c-e001-000000000f00}

ProcessId: 7104

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""Spring$((Get-Date).Year)!\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString Spring$((Get-Date).Year)! -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to Spring$((Get-Date).Year)!\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""Spring$((Get-Date).Year)!\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b6f-658c-e001-000000000f00},3588,7104,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:11.6267117Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:11.625,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:11.6267117Z""/>
      <EventRecordID>19599</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:11.625</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6f-658c-e001-000000000f00}</Data>
      <Data Name=""ProcessId"">7104</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""Spring$((Get-Date).Year)!\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString Spring$((Get-Date).Year)! -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to Spring$((Get-Date).Year)!\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""Spring$((Get-Date).Year)!\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:11.625

ProcessGuid: {f57bd86a-8b6f-658c-e001-000000000f00}

ProcessId: 7104

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""Spring$((Get-Date).Year)!\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString Spring$((Get-Date).Year)! -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to Spring$((Get-Date).Year)!\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""Spring$((Get-Date).Year)!\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:39:10.430,,,11,19598,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:39:10.430

ProcessGuid: {f57bd86a-8b6e-658c-de01-000000000f00}

ProcessId: 5916

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_y2sdh1l2.htq.ps1

CreationUtcTime: 2023-12-27 20:39:10.430

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b6e-658c-de01-000000000f00},3588,5916,,,,,"
      ",-,2023-12-27T20:39:10.4358499Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_y2sdh1l2.htq.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:10.430,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:10.4358499Z""/>
      <EventRecordID>19598</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:10.430</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6e-658c-de01-000000000f00}</Data>
      <Data Name=""ProcessId"">5916</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_y2sdh1l2.htq.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:39:10.430</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:39:10.430

ProcessGuid: {f57bd86a-8b6e-658c-de01-000000000f00}

ProcessId: 5916

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_y2sdh1l2.htq.ps1

CreationUtcTime: 2023-12-27 20:39:10.430

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""onlyUPandLowChars\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString onlyUPandLowChars -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to onlyUPandLowChars\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""onlyUPandLowChars\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19597,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:10.325

ProcessGuid: {f57bd86a-8b6e-658c-de01-000000000f00}

ProcessId: 5916

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""onlyUPandLowChars\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString onlyUPandLowChars -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to onlyUPandLowChars\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""onlyUPandLowChars\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b6e-658c-de01-000000000f00},3588,5916,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:10.3263984Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:10.325,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:10.3263984Z""/>
      <EventRecordID>19597</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:10.325</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6e-658c-de01-000000000f00}</Data>
      <Data Name=""ProcessId"">5916</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""onlyUPandLowChars\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString onlyUPandLowChars -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to onlyUPandLowChars\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""onlyUPandLowChars\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:10.325

ProcessGuid: {f57bd86a-8b6e-658c-de01-000000000f00}

ProcessId: 5916

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""onlyUPandLowChars\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString onlyUPandLowChars -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to onlyUPandLowChars\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""onlyUPandLowChars\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:39:09.121,,,11,19596,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:39:09.121

ProcessGuid: {f57bd86a-8b6d-658c-dc01-000000000f00}

ProcessId: 6152

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_ztm3nkrz.xyb.ps1

CreationUtcTime: 2023-12-27 20:39:09.121

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b6d-658c-dc01-000000000f00},3588,6152,,,,,"
      ",-,2023-12-27T20:39:09.1285596Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_ztm3nkrz.xyb.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:09.121,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:09.1285596Z""/>
      <EventRecordID>19596</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:09.121</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6d-658c-dc01-000000000f00}</Data>
      <Data Name=""ProcessId"">6152</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_ztm3nkrz.xyb.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:39:09.121</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:39:09.121

ProcessGuid: {f57bd86a-8b6d-658c-dc01-000000000f00}

ProcessId: 6152

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_ztm3nkrz.xyb.ps1

CreationUtcTime: 2023-12-27 20:39:09.121

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UPPER-LONG-SPECIAL-333\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UPPER-LONG-SPECIAL-333 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UPPER-LONG-SPECIAL-333\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UPPER-LONG-SPECIAL-333\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19595,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:09.022

ProcessGuid: {f57bd86a-8b6d-658c-dc01-000000000f00}

ProcessId: 6152

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UPPER-LONG-SPECIAL-333\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UPPER-LONG-SPECIAL-333 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UPPER-LONG-SPECIAL-333\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UPPER-LONG-SPECIAL-333\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b6d-658c-dc01-000000000f00},3588,6152,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:09.0238896Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:09.022,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:09.0238896Z""/>
      <EventRecordID>19595</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:09.022</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6d-658c-dc01-000000000f00}</Data>
      <Data Name=""ProcessId"">6152</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UPPER-LONG-SPECIAL-333\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UPPER-LONG-SPECIAL-333 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UPPER-LONG-SPECIAL-333\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UPPER-LONG-SPECIAL-333\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:09.022

ProcessGuid: {f57bd86a-8b6d-658c-dc01-000000000f00}

ProcessId: 6152

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UPPER-LONG-SPECIAL-333\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UPPER-LONG-SPECIAL-333 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UPPER-LONG-SPECIAL-333\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UPPER-LONG-SPECIAL-333\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:39:07.845,,,11,19594,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:39:07.845

ProcessGuid: {f57bd86a-8b6b-658c-da01-000000000f00}

ProcessId: 1296

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bz5rzm1c.mlh.ps1

CreationUtcTime: 2023-12-27 20:39:07.845

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b6b-658c-da01-000000000f00},3588,1296,,,,,"
      ",-,2023-12-27T20:39:07.8478009Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bz5rzm1c.mlh.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:07.845,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:07.8478009Z""/>
      <EventRecordID>19594</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:07.845</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6b-658c-da01-000000000f00}</Data>
      <Data Name=""ProcessId"">1296</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bz5rzm1c.mlh.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:39:07.845</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:39:07.845

ProcessGuid: {f57bd86a-8b6b-658c-da01-000000000f00}

ProcessId: 1296

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bz5rzm1c.mlh.ps1

CreationUtcTime: 2023-12-27 20:39:07.845

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""lower-long-special-333\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString lower-long-special-333 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to lower-long-special-333\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""lower-long-special-333\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19593,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:07.729

ProcessGuid: {f57bd86a-8b6b-658c-da01-000000000f00}

ProcessId: 1296

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""lower-long-special-333\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString lower-long-special-333 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to lower-long-special-333\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""lower-long-special-333\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b6b-658c-da01-000000000f00},3588,1296,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:07.7306811Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:07.729,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:07.7306811Z""/>
      <EventRecordID>19593</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:07.729</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6b-658c-da01-000000000f00}</Data>
      <Data Name=""ProcessId"">1296</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""lower-long-special-333\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString lower-long-special-333 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to lower-long-special-333\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""lower-long-special-333\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:07.729

ProcessGuid: {f57bd86a-8b6b-658c-da01-000000000f00}

ProcessId: 1296

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""lower-long-special-333\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString lower-long-special-333 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to lower-long-special-333\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""lower-long-special-333\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:39:06.551,,,11,19592,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:39:06.551

ProcessGuid: {f57bd86a-8b6a-658c-d801-000000000f00}

ProcessId: 11060

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_drvnzopl.klu.ps1

CreationUtcTime: 2023-12-27 20:39:06.551

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b6a-658c-d801-000000000f00},3588,11060,,,,,"
      ",-,2023-12-27T20:39:06.5515802Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_drvnzopl.klu.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:06.551,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:06.5515802Z""/>
      <EventRecordID>19592</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:06.551</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6a-658c-d801-000000000f00}</Data>
      <Data Name=""ProcessId"">11060</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_drvnzopl.klu.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:39:06.551</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:39:06.551

ProcessGuid: {f57bd86a-8b6a-658c-d801-000000000f00}

ProcessId: 11060

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_drvnzopl.klu.ps1

CreationUtcTime: 2023-12-27 20:39:06.551

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UpperLowerLong333noSpecialChar\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UpperLowerLong333noSpecialChar -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UpperLowerLong333noSpecialChar\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UpperLowerLong333noSpecialChar\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19591,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:06.438

ProcessGuid: {f57bd86a-8b6a-658c-d801-000000000f00}

ProcessId: 11060

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UpperLowerLong333noSpecialChar\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UpperLowerLong333noSpecialChar -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UpperLowerLong333noSpecialChar\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UpperLowerLong333noSpecialChar\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b6a-658c-d801-000000000f00},3588,11060,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:06.4408004Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:06.438,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:06.4408004Z""/>
      <EventRecordID>19591</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:06.438</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b6a-658c-d801-000000000f00}</Data>
      <Data Name=""ProcessId"">11060</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UpperLowerLong333noSpecialChar\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UpperLowerLong333noSpecialChar -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UpperLowerLong333noSpecialChar\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UpperLowerLong333noSpecialChar\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:06.438

ProcessGuid: {f57bd86a-8b6a-658c-d801-000000000f00}

ProcessId: 11060

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UpperLowerLong333noSpecialChar\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UpperLowerLong333noSpecialChar -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UpperLowerLong333noSpecialChar\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UpperLowerLong333noSpecialChar\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:39:05.255,,,11,19590,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:39:05.255

ProcessGuid: {f57bd86a-8b69-658c-d601-000000000f00}

ProcessId: 10412

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_tt1g0zfi.oz5.ps1

CreationUtcTime: 2023-12-27 20:39:05.255

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b69-658c-d601-000000000f00},3588,10412,,,,,"
      ",-,2023-12-27T20:39:05.2589845Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_tt1g0zfi.oz5.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:05.255,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:05.2589845Z""/>
      <EventRecordID>19590</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:05.255</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b69-658c-d601-000000000f00}</Data>
      <Data Name=""ProcessId"">10412</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_tt1g0zfi.oz5.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:39:05.255</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:39:05.255

ProcessGuid: {f57bd86a-8b69-658c-d601-000000000f00}

ProcessId: 10412

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_tt1g0zfi.oz5.ps1

CreationUtcTime: 2023-12-27 20:39:05.255

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UpperLowerLong-special\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UpperLowerLong-special\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UpperLowerLong-special\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19589,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:05.135

ProcessGuid: {f57bd86a-8b69-658c-d601-000000000f00}

ProcessId: 10412

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UpperLowerLong-special\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UpperLowerLong-special\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UpperLowerLong-special\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b69-658c-d601-000000000f00},3588,10412,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:05.1362967Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:05.135,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:05.1362967Z""/>
      <EventRecordID>19589</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:05.135</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b69-658c-d601-000000000f00}</Data>
      <Data Name=""ProcessId"">10412</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UpperLowerLong-special\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UpperLowerLong-special\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UpperLowerLong-special\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:05.135

ProcessGuid: {f57bd86a-8b69-658c-d601-000000000f00}

ProcessId: 10412

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""UpperLowerLong-special\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString UpperLowerLong-special -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to UpperLowerLong-special\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""UpperLowerLong-special\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:39:03.767,,,11,19588,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:39:03.767

ProcessGuid: {f57bd86a-8b67-658c-d401-000000000f00}

ProcessId: 5612

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_hhe5ic1b.ig1.ps1

CreationUtcTime: 2023-12-27 20:39:03.767

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b67-658c-d401-000000000f00},3588,5612,,,,,"
      ",-,2023-12-27T20:39:03.7787679Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_hhe5ic1b.ig1.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:03.767,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:03.7787679Z""/>
      <EventRecordID>19588</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:03.767</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b67-658c-d401-000000000f00}</Data>
      <Data Name=""ProcessId"">5612</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_hhe5ic1b.ig1.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:39:03.767</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:39:03.767

ProcessGuid: {f57bd86a-8b67-658c-d401-000000000f00}

ProcessId: 5612

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_hhe5ic1b.ig1.ps1

CreationUtcTime: 2023-12-27 20:39:03.767

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""Uplow-1\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString Uplow-1 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to Uplow-1\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""Uplow-1\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19587,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:03.658

ProcessGuid: {f57bd86a-8b67-658c-d401-000000000f00}

ProcessId: 5612

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""Uplow-1\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString Uplow-1 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to Uplow-1\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""Uplow-1\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b67-658c-d401-000000000f00},3588,5612,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:03.6592425Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:03.658,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:03.6592425Z""/>
      <EventRecordID>19587</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:03.658</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b67-658c-d401-000000000f00}</Data>
      <Data Name=""ProcessId"">5612</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""Uplow-1\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString Uplow-1 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to Uplow-1\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""Uplow-1\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:03.658

ProcessGuid: {f57bd86a-8b67-658c-d401-000000000f00}

ProcessId: 5612

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {$credFile = \""""$env:LOCALAPPDATA\AtomicRedTeam\$env:USERNAME.txt\""""
if (Test-Path $credFile) {
    $cred = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $env:USERNAME, (Get-Content $credFile | ConvertTo-SecureString)
    if($cred.GetNetworkCredential().Password -eq \""""Uplow-1\""""){
      Write-Host -ForegroundColor Yellow \""""The new password is the same as the password stored in the credential file. Please specify a different new password.\""""; exit -1
    }
    try {
        $newPassword = ConvertTo-SecureString Uplow-1 -AsPlainText -Force
        Set-ADAccountPassword -Identity $env:USERNAME -OldPassword $cred.password -NewPassword $newPassword
    }
    catch { 
        $_.Exception
        $errCode = $_.Exception.ErrorCode
        Write-Host \""""Error code: $errCode\""""
        if ($errCode -eq 86) {
            Write-Host -ForegroundColor Yellow \""""The stored password for the current user is incorrect. Please run the prereq commands to set the correct credentials\""""
            Remove-Item $credFile
        }
        exit $errCode
    }
    Write-Host -ForegroundColor Cyan \""""Successfully changed the password to Uplow-1\""""
    $newCred = New-Object System.Management.Automation.PSCredential ($env:USERNAME, $(ConvertTo-SecureString \""""Uplow-1\"""" -AsPlainText -Force))
    $newCred.Password | ConvertFrom-SecureString | Out-File $credFile
}
else {
    Write-Host -ForegroundColor Yellow \""""You must store the password of the current user by running the prerequisite commands first\""""
}}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""cmd.exe"" /c ntdsutil ""set dsrm password"" ""sync from domain account %%username%%"" ""q"" ""q""",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows Command Processor,1,19586,10.0.22621.2506 (WinBuild.160101.0800),"MD5=133D568ECCB557E37BEA1459521CBAC2,SHA256=05A30592D2C3421C41121145C6EEFA7C81FEA6B42D6233A522240A8468326B9C,IMPHASH=D73E39DAB3C8B57AA408073D01254964",C:\Windows\System32\cmd.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:03.419

ProcessGuid: {f57bd86a-8b67-658c-d201-000000000f00}

ProcessId: 7104

Image: C:\Windows\System32\cmd.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows Command Processor

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: Cmd.Exe

CommandLine: ""cmd.exe"" /c ntdsutil ""set dsrm password"" ""sync from domain account %%username%%"" ""q"" ""q""

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=133D568ECCB557E37BEA1459521CBAC2,SHA256=05A30592D2C3421C41121145C6EEFA7C81FEA6B42D6233A522240A8468326B9C,IMPHASH=D73E39DAB3C8B57AA408073D01254964

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,Cmd.Exe,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b67-658c-d201-000000000f00},3588,7104,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:03.4208128Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:03.419,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:03.4208128Z""/>
      <EventRecordID>19586</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:03.419</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b67-658c-d201-000000000f00}</Data>
      <Data Name=""ProcessId"">7104</Data>
      <Data Name=""Image"">C:\Windows\System32\cmd.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows Command Processor</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">Cmd.Exe</Data>
      <Data Name=""CommandLine"">""cmd.exe"" /c ntdsutil ""set dsrm password"" ""sync from domain account %%username%%"" ""q"" ""q""</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=133D568ECCB557E37BEA1459521CBAC2,SHA256=05A30592D2C3421C41121145C6EEFA7C81FEA6B42D6233A522240A8468326B9C,IMPHASH=D73E39DAB3C8B57AA408073D01254964</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:03.419

ProcessGuid: {f57bd86a-8b67-658c-d201-000000000f00}

ProcessId: 7104

Image: C:\Windows\System32\cmd.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows Command Processor

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: Cmd.Exe

CommandLine: ""cmd.exe"" /c ntdsutil ""set dsrm password"" ""sync from domain account %%username%%"" ""q"" ""q""

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=133D568ECCB557E37BEA1459521CBAC2,SHA256=05A30592D2C3421C41121145C6EEFA7C81FEA6B42D6233A522240A8468326B9C,IMPHASH=D73E39DAB3C8B57AA408073D01254964

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:39:01.752,,,11,19585,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:39:01.752

ProcessGuid: {f57bd86a-8b65-658c-d001-000000000f00}

ProcessId: 1616

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_rnaxif5e.z2y.ps1

CreationUtcTime: 2023-12-27 20:39:01.752

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b65-658c-d001-000000000f00},3588,1616,,,,,"
      ",-,2023-12-27T20:39:01.7631602Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_rnaxif5e.z2y.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:01.752,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:01.7631602Z""/>
      <EventRecordID>19585</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:01.752</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b65-658c-d001-000000000f00}</Data>
      <Data Name=""ProcessId"">1616</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_rnaxif5e.z2y.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:39:01.752</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:39:01.752

ProcessGuid: {f57bd86a-8b65-658c-d001-000000000f00}

ProcessId: 1616

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_rnaxif5e.z2y.ps1

CreationUtcTime: 2023-12-27 20:39:01.752

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$aadApplication = New-AzureADApplication -DisplayName \""""test_app\""""
$servicePrincipal = New-AzureADServicePrincipal -AppId $aadApplication.AppId
#$aadApplication = Get-AzureADApplication -Filter \""""DisplayName eq 'test_app'\""""

#Get Service Principal of Microsoft Graph Resource API 
$graphSP = Get-AzureADServicePrincipal -Filter \""""DisplayName eq 'Microsoft Graph'\""""

#Initialize RequiredResourceAccess for Microsoft Graph Resource API 
$requiredGraphAccess = New-Object Microsoft.Open.AzureAD.Model.RequiredResourceAccess
$requiredGraphAccess.ResourceAppId = $graphSP.AppId
$requiredGraphAccess.ResourceAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.ResourceAccess]

#Set Application Permissions
$ApplicationPermissions = @('DirectoryRecommendations.Read.All')

$reqPermission = $graphSP.AppRoles | Where-Object {$_.Value -eq $ApplicationPermissions}
if($reqPermission)
{
$resourceAccess = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$resourceAccess.Type = \""""Role\""""
$resourceAccess.Id = $reqPermission.Id    
#Add required app permission
$requiredGraphAccess.ResourceAccess.Add($resourceAccess)
}
else
{
Write-Host \""""App permission $permission not found in the Graph Resource API\"""" -ForegroundColor Red
}

#Add required resource accesses
$requiredResourcesAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.RequiredResourceAccess]
$requiredResourcesAccess.Add($requiredGraphAccess)

#Set permissions in existing Azure AD App
Set-AzureADApplication -ObjectId $aadApplication.ObjectId -RequiredResourceAccess $requiredResourcesAccess

$servicePrincipal = Get-AzureADServicePrincipal -Filter \""""AppId eq '$($aadApplication.AppId)'\""""

New-AzureADServiceAppRoleAssignment -ObjectId $servicePrincipal.ObjectId -PrincipalId $servicePrincipal.ObjectId -ResourceId $graphSP.ObjectId -Id $reqPermission.Id}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19584,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:01.646

ProcessGuid: {f57bd86a-8b65-658c-d001-000000000f00}

ProcessId: 1616

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$aadApplication = New-AzureADApplication -DisplayName \""""test_app\""""
$servicePrincipal = New-AzureADServicePrincipal -AppId $aadApplication.AppId
#$aadApplication = Get-AzureADApplication -Filter \""""DisplayName eq 'test_app'\""""

#Get Service Principal of Microsoft Graph Resource API 
$graphSP = Get-AzureADServicePrincipal -Filter \""""DisplayName eq 'Microsoft Graph'\""""

#Initialize RequiredResourceAccess for Microsoft Graph Resource API 
$requiredGraphAccess = New-Object Microsoft.Open.AzureAD.Model.RequiredResourceAccess
$requiredGraphAccess.ResourceAppId = $graphSP.AppId
$requiredGraphAccess.ResourceAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.ResourceAccess]

#Set Application Permissions
$ApplicationPermissions = @('DirectoryRecommendations.Read.All')

$reqPermission = $graphSP.AppRoles | Where-Object {$_.Value -eq $ApplicationPermissions}
if($reqPermission)
{
$resourceAccess = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$resourceAccess.Type = \""""Role\""""
$resourceAccess.Id = $reqPermission.Id    
#Add required app permission
$requiredGraphAccess.ResourceAccess.Add($resourceAccess)
}
else
{
Write-Host \""""App permission $permission not found in the Graph Resource API\"""" -ForegroundColor Red
}

#Add required resource accesses
$requiredResourcesAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.RequiredResourceAccess]
$requiredResourcesAccess.Add($requiredGraphAccess)

#Set permissions in existing Azure AD App
Set-AzureADApplication -ObjectId $aadApplication.ObjectId -RequiredResourceAccess $requiredResourcesAccess

$servicePrincipal = Get-AzureADServicePrincipal -Filter \""""AppId eq '$($aadApplication.AppId)'\""""

New-AzureADServiceAppRoleAssignment -ObjectId $servicePrincipal.ObjectId -PrincipalId $servicePrincipal.ObjectId -ResourceId $graphSP.ObjectId -Id $reqPermission.Id}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b65-658c-d001-000000000f00},3588,1616,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:01.6478472Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:01.646,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:01.6478472Z""/>
      <EventRecordID>19584</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:01.646</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b65-658c-d001-000000000f00}</Data>
      <Data Name=""ProcessId"">1616</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$aadApplication = New-AzureADApplication -DisplayName \""""test_app\""""
$servicePrincipal = New-AzureADServicePrincipal -AppId $aadApplication.AppId
#$aadApplication = Get-AzureADApplication -Filter \""""DisplayName eq 'test_app'\""""

#Get Service Principal of Microsoft Graph Resource API 
$graphSP = Get-AzureADServicePrincipal -Filter \""""DisplayName eq 'Microsoft Graph'\""""

#Initialize RequiredResourceAccess for Microsoft Graph Resource API 
$requiredGraphAccess = New-Object Microsoft.Open.AzureAD.Model.RequiredResourceAccess
$requiredGraphAccess.ResourceAppId = $graphSP.AppId
$requiredGraphAccess.ResourceAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.ResourceAccess]

#Set Application Permissions
$ApplicationPermissions = @('DirectoryRecommendations.Read.All')

$reqPermission = $graphSP.AppRoles | Where-Object {$_.Value -eq $ApplicationPermissions}
if($reqPermission)
{
$resourceAccess = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$resourceAccess.Type = \""""Role\""""
$resourceAccess.Id = $reqPermission.Id    
#Add required app permission
$requiredGraphAccess.ResourceAccess.Add($resourceAccess)
}
else
{
Write-Host \""""App permission $permission not found in the Graph Resource API\"""" -ForegroundColor Red
}

#Add required resource accesses
$requiredResourcesAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.RequiredResourceAccess]
$requiredResourcesAccess.Add($requiredGraphAccess)

#Set permissions in existing Azure AD App
Set-AzureADApplication -ObjectId $aadApplication.ObjectId -RequiredResourceAccess $requiredResourcesAccess

$servicePrincipal = Get-AzureADServicePrincipal -Filter \""""AppId eq '$($aadApplication.AppId)'\""""

New-AzureADServiceAppRoleAssignment -ObjectId $servicePrincipal.ObjectId -PrincipalId $servicePrincipal.ObjectId -ResourceId $graphSP.ObjectId -Id $reqPermission.Id}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:01.646

ProcessGuid: {f57bd86a-8b65-658c-d001-000000000f00}

ProcessId: 1616

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$aadApplication = New-AzureADApplication -DisplayName \""""test_app\""""
$servicePrincipal = New-AzureADServicePrincipal -AppId $aadApplication.AppId
#$aadApplication = Get-AzureADApplication -Filter \""""DisplayName eq 'test_app'\""""

#Get Service Principal of Microsoft Graph Resource API 
$graphSP = Get-AzureADServicePrincipal -Filter \""""DisplayName eq 'Microsoft Graph'\""""

#Initialize RequiredResourceAccess for Microsoft Graph Resource API 
$requiredGraphAccess = New-Object Microsoft.Open.AzureAD.Model.RequiredResourceAccess
$requiredGraphAccess.ResourceAppId = $graphSP.AppId
$requiredGraphAccess.ResourceAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.ResourceAccess]

#Set Application Permissions
$ApplicationPermissions = @('DirectoryRecommendations.Read.All')

$reqPermission = $graphSP.AppRoles | Where-Object {$_.Value -eq $ApplicationPermissions}
if($reqPermission)
{
$resourceAccess = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$resourceAccess.Type = \""""Role\""""
$resourceAccess.Id = $reqPermission.Id    
#Add required app permission
$requiredGraphAccess.ResourceAccess.Add($resourceAccess)
}
else
{
Write-Host \""""App permission $permission not found in the Graph Resource API\"""" -ForegroundColor Red
}

#Add required resource accesses
$requiredResourcesAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.RequiredResourceAccess]
$requiredResourcesAccess.Add($requiredGraphAccess)

#Set permissions in existing Azure AD App
Set-AzureADApplication -ObjectId $aadApplication.ObjectId -RequiredResourceAccess $requiredResourcesAccess

$servicePrincipal = Get-AzureADServicePrincipal -Filter \""""AppId eq '$($aadApplication.AppId)'\""""

New-AzureADServiceAppRoleAssignment -ObjectId $servicePrincipal.ObjectId -PrincipalId $servicePrincipal.ObjectId -ResourceId $graphSP.ObjectId -Id $reqPermission.Id}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:39:00.193,,,11,19583,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:39:00.193

ProcessGuid: {f57bd86a-8b64-658c-ce01-000000000f00}

ProcessId: 10820

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_h5ijazxr.yuv.ps1

CreationUtcTime: 2023-12-27 20:39:00.193

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b64-658c-ce01-000000000f00},3588,10820,,,,,"
      ",-,2023-12-27T20:39:00.2014346Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_h5ijazxr.yuv.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:00.193,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:00.2014346Z""/>
      <EventRecordID>19583</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:00.193</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b64-658c-ce01-000000000f00}</Data>
      <Data Name=""ProcessId"">10820</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_h5ijazxr.yuv.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:39:00.193</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:39:00.193

ProcessGuid: {f57bd86a-8b64-658c-ce01-000000000f00}

ProcessId: 10820

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_h5ijazxr.yuv.ps1

CreationUtcTime: 2023-12-27 20:39:00.193

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzAccount -Credential $Credential

$sp = Get-AzADServicePrincipal | where-object {$_.DisplayName -eq \""""SuperSP\""""}
if ($sp -eq $null) { Write-Warning \""""Service Principal not found\""""; exit }
$subscription = Get-AzSubscription | where-object {$_.Name -eq \""""Azure subscription 1\""""} 
if ($subscription -eq $null) { Write-Warning \""""Subscription not found\""""; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq \""""Reader\""""}
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }

New-AzRoleAssignment -ObjectId $sp.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host \""""Service Principal $($sp.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)\""""}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19582,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:00.093

ProcessGuid: {f57bd86a-8b64-658c-ce01-000000000f00}

ProcessId: 10820

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzAccount -Credential $Credential

$sp = Get-AzADServicePrincipal | where-object {$_.DisplayName -eq \""""SuperSP\""""}
if ($sp -eq $null) { Write-Warning \""""Service Principal not found\""""; exit }
$subscription = Get-AzSubscription | where-object {$_.Name -eq \""""Azure subscription 1\""""} 
if ($subscription -eq $null) { Write-Warning \""""Subscription not found\""""; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq \""""Reader\""""}
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }

New-AzRoleAssignment -ObjectId $sp.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host \""""Service Principal $($sp.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b64-658c-ce01-000000000f00},3588,10820,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:39:00.0950934Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:39:00.093,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:39:00.0950934Z""/>
      <EventRecordID>19582</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:39:00.093</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b64-658c-ce01-000000000f00}</Data>
      <Data Name=""ProcessId"">10820</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzAccount -Credential $Credential

$sp = Get-AzADServicePrincipal | where-object {$_.DisplayName -eq \""""SuperSP\""""}
if ($sp -eq $null) { Write-Warning \""""Service Principal not found\""""; exit }
$subscription = Get-AzSubscription | where-object {$_.Name -eq \""""Azure subscription 1\""""} 
if ($subscription -eq $null) { Write-Warning \""""Subscription not found\""""; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq \""""Reader\""""}
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }

New-AzRoleAssignment -ObjectId $sp.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host \""""Service Principal $($sp.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)\""""}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:39:00.093

ProcessGuid: {f57bd86a-8b64-658c-ce01-000000000f00}

ProcessId: 10820

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzAccount -Credential $Credential

$sp = Get-AzADServicePrincipal | where-object {$_.DisplayName -eq \""""SuperSP\""""}
if ($sp -eq $null) { Write-Warning \""""Service Principal not found\""""; exit }
$subscription = Get-AzSubscription | where-object {$_.Name -eq \""""Azure subscription 1\""""} 
if ($subscription -eq $null) { Write-Warning \""""Subscription not found\""""; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq \""""Reader\""""}
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }

New-AzRoleAssignment -ObjectId $sp.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host \""""Service Principal $($sp.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:38:58.610,,,11,19581,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:38:58.610

ProcessGuid: {f57bd86a-8b62-658c-cc01-000000000f00}

ProcessId: 4476

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bpbhvkeu.way.ps1

CreationUtcTime: 2023-12-27 20:38:58.610

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b62-658c-cc01-000000000f00},3588,4476,,,,,"
      ",-,2023-12-27T20:38:58.6167716Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bpbhvkeu.way.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:58.610,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:58.6167716Z""/>
      <EventRecordID>19581</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:58.610</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b62-658c-cc01-000000000f00}</Data>
      <Data Name=""ProcessId"">4476</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bpbhvkeu.way.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:38:58.610</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:38:58.610

ProcessGuid: {f57bd86a-8b62-658c-cc01-000000000f00}

ProcessId: 4476

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bpbhvkeu.way.ps1

CreationUtcTime: 2023-12-27 20:38:58.610

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzAccount -Credential $Credential

$user = Get-AzADUser | where-object {$_.DisplayName -eq \""""SuperUser\"""" -or $_.UserPrincipalName -eq \""""SuperUser\"""" }
if ($user -eq $null) { Write-Warning \""""User not found\""""; exit }
$subscription = Get-AzSubscription | where-object {$_.Name -eq \""""Azure subscription 1\""""}
if ($subscription -eq $null) { Write-Warning \""""Subscription not found\""""; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq \""""Reader\""""}
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }

New-AzRoleAssignment -ObjectId $user.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host \""""User $($user.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)\""""}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19580,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:58.503

ProcessGuid: {f57bd86a-8b62-658c-cc01-000000000f00}

ProcessId: 4476

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzAccount -Credential $Credential

$user = Get-AzADUser | where-object {$_.DisplayName -eq \""""SuperUser\"""" -or $_.UserPrincipalName -eq \""""SuperUser\"""" }
if ($user -eq $null) { Write-Warning \""""User not found\""""; exit }
$subscription = Get-AzSubscription | where-object {$_.Name -eq \""""Azure subscription 1\""""}
if ($subscription -eq $null) { Write-Warning \""""Subscription not found\""""; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq \""""Reader\""""}
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }

New-AzRoleAssignment -ObjectId $user.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host \""""User $($user.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b62-658c-cc01-000000000f00},3588,4476,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:38:58.5045046Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:58.503,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:58.5045046Z""/>
      <EventRecordID>19580</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:58.503</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b62-658c-cc01-000000000f00}</Data>
      <Data Name=""ProcessId"">4476</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzAccount -Credential $Credential

$user = Get-AzADUser | where-object {$_.DisplayName -eq \""""SuperUser\"""" -or $_.UserPrincipalName -eq \""""SuperUser\"""" }
if ($user -eq $null) { Write-Warning \""""User not found\""""; exit }
$subscription = Get-AzSubscription | where-object {$_.Name -eq \""""Azure subscription 1\""""}
if ($subscription -eq $null) { Write-Warning \""""Subscription not found\""""; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq \""""Reader\""""}
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }

New-AzRoleAssignment -ObjectId $user.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host \""""User $($user.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)\""""}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:58.503

ProcessGuid: {f57bd86a-8b62-658c-cc01-000000000f00}

ProcessId: 4476

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzAccount -Credential $Credential

$user = Get-AzADUser | where-object {$_.DisplayName -eq \""""SuperUser\"""" -or $_.UserPrincipalName -eq \""""SuperUser\"""" }
if ($user -eq $null) { Write-Warning \""""User not found\""""; exit }
$subscription = Get-AzSubscription | where-object {$_.Name -eq \""""Azure subscription 1\""""}
if ($subscription -eq $null) { Write-Warning \""""Subscription not found\""""; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq \""""Reader\""""}
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }

New-AzRoleAssignment -ObjectId $user.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host \""""User $($user.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:38:57.051,,,11,19579,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:38:57.051

ProcessGuid: {f57bd86a-8b60-658c-ca01-000000000f00}

ProcessId: 820

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bvi2sict.riv.ps1

CreationUtcTime: 2023-12-27 20:38:57.051

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b60-658c-ca01-000000000f00},3588,820,,,,,"
      ",-,2023-12-27T20:38:57.0526204Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bvi2sict.riv.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:57.051,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:57.0526204Z""/>
      <EventRecordID>19579</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:57.051</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b60-658c-ca01-000000000f00}</Data>
      <Data Name=""ProcessId"">820</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bvi2sict.riv.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:38:57.051</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:38:57.051

ProcessGuid: {f57bd86a-8b60-658c-ca01-000000000f00}

ProcessId: 820

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_bvi2sict.riv.ps1

CreationUtcTime: 2023-12-27 20:38:57.051

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$sp = Get-AzureADServicePrincipal -Filter \""""DisplayName eq 'SuperSP'\""""
if ($sp -eq $null) { Write-Warning \""""Service Principal not found\""""; exit }
$role = Get-AzureADDirectoryRole -Filter \""""DisplayName eq 'Global Reader'\""""
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId
Write-Host \""""Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\""""}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19578,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:56.939

ProcessGuid: {f57bd86a-8b60-658c-ca01-000000000f00}

ProcessId: 820

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$sp = Get-AzureADServicePrincipal -Filter \""""DisplayName eq 'SuperSP'\""""
if ($sp -eq $null) { Write-Warning \""""Service Principal not found\""""; exit }
$role = Get-AzureADDirectoryRole -Filter \""""DisplayName eq 'Global Reader'\""""
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId
Write-Host \""""Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b60-658c-ca01-000000000f00},3588,820,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:38:56.9417393Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:56.939,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:56.9417393Z""/>
      <EventRecordID>19578</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:56.939</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b60-658c-ca01-000000000f00}</Data>
      <Data Name=""ProcessId"">820</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$sp = Get-AzureADServicePrincipal -Filter \""""DisplayName eq 'SuperSP'\""""
if ($sp -eq $null) { Write-Warning \""""Service Principal not found\""""; exit }
$role = Get-AzureADDirectoryRole -Filter \""""DisplayName eq 'Global Reader'\""""
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId
Write-Host \""""Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\""""}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:56.939

ProcessGuid: {f57bd86a-8b60-658c-ca01-000000000f00}

ProcessId: 820

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$sp = Get-AzureADServicePrincipal -Filter \""""DisplayName eq 'SuperSP'\""""
if ($sp -eq $null) { Write-Warning \""""Service Principal not found\""""; exit }
$role = Get-AzureADDirectoryRole -Filter \""""DisplayName eq 'Global Reader'\""""
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId
Write-Host \""""Service Principal $($sp.DisplayName) was added to $($role.DisplayName)\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:38:55.465,,,11,19577,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:38:55.465

ProcessGuid: {f57bd86a-8b5f-658c-c801-000000000f00}

ProcessId: 6412

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_n3y2vmy1.hzm.ps1

CreationUtcTime: 2023-12-27 20:38:55.465

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b5f-658c-c801-000000000f00},3588,6412,,,,,"
      ",-,2023-12-27T20:38:55.4778038Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_n3y2vmy1.hzm.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:55.465,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:55.4778038Z""/>
      <EventRecordID>19577</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:55.465</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b5f-658c-c801-000000000f00}</Data>
      <Data Name=""ProcessId"">6412</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_n3y2vmy1.hzm.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:38:55.465</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:38:55.465

ProcessGuid: {f57bd86a-8b5f-658c-c801-000000000f00}

ProcessId: 6412

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_n3y2vmy1.hzm.ps1

CreationUtcTime: 2023-12-27 20:38:55.465

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$user = Get-AzureADUser -Filter \""""DisplayName eq 'SuperUser' or UserPrincipalName eq 'SuperUser'\""""
if ($user -eq $null) { Write-Warning \""""User not found\""""; exit }
$role = Get-AzureADDirectoryRole -Filter \""""DisplayName eq 'Global Reader'\""""
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $user.ObjectId
Write-Host \""""User $($user.DisplayName) was added to $($role.DisplayName) role\""""}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19576,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:55.356

ProcessGuid: {f57bd86a-8b5f-658c-c801-000000000f00}

ProcessId: 6412

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$user = Get-AzureADUser -Filter \""""DisplayName eq 'SuperUser' or UserPrincipalName eq 'SuperUser'\""""
if ($user -eq $null) { Write-Warning \""""User not found\""""; exit }
$role = Get-AzureADDirectoryRole -Filter \""""DisplayName eq 'Global Reader'\""""
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $user.ObjectId
Write-Host \""""User $($user.DisplayName) was added to $($role.DisplayName) role\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b5f-658c-c801-000000000f00},3588,6412,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:38:55.3578203Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:55.356,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:55.3578203Z""/>
      <EventRecordID>19576</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:55.356</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b5f-658c-c801-000000000f00}</Data>
      <Data Name=""ProcessId"">6412</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$user = Get-AzureADUser -Filter \""""DisplayName eq 'SuperUser' or UserPrincipalName eq 'SuperUser'\""""
if ($user -eq $null) { Write-Warning \""""User not found\""""; exit }
$role = Get-AzureADDirectoryRole -Filter \""""DisplayName eq 'Global Reader'\""""
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $user.ObjectId
Write-Host \""""User $($user.DisplayName) was added to $($role.DisplayName) role\""""}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:55.356

ProcessGuid: {f57bd86a-8b5f-658c-c801-000000000f00}

ProcessId: 6412

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String \""""p4sswd\"""" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList \""""jonh@contoso.com\"""", $Pword
Connect-AzureAD -Credential $Credential

$user = Get-AzureADUser -Filter \""""DisplayName eq 'SuperUser' or UserPrincipalName eq 'SuperUser'\""""
if ($user -eq $null) { Write-Warning \""""User not found\""""; exit }
$role = Get-AzureADDirectoryRole -Filter \""""DisplayName eq 'Global Reader'\""""
if ($role -eq $null) { Write-Warning \""""Role not found\""""; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $user.ObjectId
Write-Host \""""User $($user.DisplayName) was added to $($role.DisplayName) role\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:38:53.743,,,11,19575,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:38:53.743

ProcessGuid: {f57bd86a-8b5d-658c-c601-000000000f00}

ProcessId: 2744

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_5hqkbu1h.yao.ps1

CreationUtcTime: 2023-12-27 20:38:53.743

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b5d-658c-c601-000000000f00},3588,2744,,,,,"
      ",-,2023-12-27T20:38:53.7488080Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_5hqkbu1h.yao.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:53.743,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:53.7488080Z""/>
      <EventRecordID>19575</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:53.743</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b5d-658c-c601-000000000f00}</Data>
      <Data Name=""ProcessId"">2744</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_5hqkbu1h.yao.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:38:53.743</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:38:53.743

ProcessGuid: {f57bd86a-8b5d-658c-c601-000000000f00}

ProcessId: 2744

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_5hqkbu1h.yao.ps1

CreationUtcTime: 2023-12-27 20:38:53.743

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {$x = Get-Random -Minimum 2 -Maximum 99
$y = Get-Random -Minimum 2 -Maximum 99
$z = Get-Random -Minimum 2 -Maximum 99
$w = Get-Random -Minimum 2 -Maximum 99

Import-Module ActiveDirectory
$account = \""""atr--$x$y$z\""""
New-ADUser -Name $account -GivenName \""""Test\"""" -DisplayName $account -SamAccountName $account -Surname $account -Enabled:$False 
Add-ADGroupMember \""""Domain Admins\"""" $account}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19574,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:53.626

ProcessGuid: {f57bd86a-8b5d-658c-c601-000000000f00}

ProcessId: 2744

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {$x = Get-Random -Minimum 2 -Maximum 99
$y = Get-Random -Minimum 2 -Maximum 99
$z = Get-Random -Minimum 2 -Maximum 99
$w = Get-Random -Minimum 2 -Maximum 99

Import-Module ActiveDirectory
$account = \""""atr--$x$y$z\""""
New-ADUser -Name $account -GivenName \""""Test\"""" -DisplayName $account -SamAccountName $account -Surname $account -Enabled:$False 
Add-ADGroupMember \""""Domain Admins\"""" $account}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b5d-658c-c601-000000000f00},3588,2744,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:38:53.6276233Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:53.626,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:53.6276233Z""/>
      <EventRecordID>19574</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:53.626</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b5d-658c-c601-000000000f00}</Data>
      <Data Name=""ProcessId"">2744</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {$x = Get-Random -Minimum 2 -Maximum 99
$y = Get-Random -Minimum 2 -Maximum 99
$z = Get-Random -Minimum 2 -Maximum 99
$w = Get-Random -Minimum 2 -Maximum 99

Import-Module ActiveDirectory
$account = \""""atr--$x$y$z\""""
New-ADUser -Name $account -GivenName \""""Test\"""" -DisplayName $account -SamAccountName $account -Surname $account -Enabled:$False 
Add-ADGroupMember \""""Domain Admins\"""" $account}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:53.626

ProcessGuid: {f57bd86a-8b5d-658c-c601-000000000f00}

ProcessId: 2744

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {$x = Get-Random -Minimum 2 -Maximum 99
$y = Get-Random -Minimum 2 -Maximum 99
$z = Get-Random -Minimum 2 -Maximum 99
$w = Get-Random -Minimum 2 -Maximum 99

Import-Module ActiveDirectory
$account = \""""atr--$x$y$z\""""
New-ADUser -Name $account -GivenName \""""Test\"""" -DisplayName $account -SamAccountName $account -Surname $account -Enabled:$False 
Add-ADGroupMember \""""Domain Admins\"""" $account}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 20:38:50.470,,,11,19573,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 20:38:50.470

ProcessGuid: {f57bd86a-8b5a-658c-c401-000000000f00}

ProcessId: 9192

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_dnvuo5sc.h3m.ps1

CreationUtcTime: 2023-12-27 20:38:50.470

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-8b5a-658c-c401-000000000f00},3588,9192,,,,,"
      ",-,2023-12-27T20:38:50.4827586Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_dnvuo5sc.h3m.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:50.470,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:50.4827586Z""/>
      <EventRecordID>19573</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:50.470</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b5a-658c-c401-000000000f00}</Data>
      <Data Name=""ProcessId"">9192</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_dnvuo5sc.h3m.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 20:38:50.470</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 20:38:50.470

ProcessGuid: {f57bd86a-8b5a-658c-c401-000000000f00}

ProcessId: 9192

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_dnvuo5sc.h3m.ps1

CreationUtcTime: 2023-12-27 20:38:50.470

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {$x = Get-Random -Minimum 2 -Maximum 9999
$y = Get-Random -Minimum 2 -Maximum 9999
$z = Get-Random -Minimum 2 -Maximum 9999
$w = Get-Random -Minimum 2 -Maximum 9999
Write-Host HaHa_$x$y$z

$fmm = Get-LocalGroupMember -Group Administrators |?{ $_.ObjectClass -match \""""User\"""" -and $_.PrincipalSource -match \""""Local\""""} | Select Name

foreach($member in $fmm) {
    if($member -like \""""*Administrator*\"""") {
        $account = $member.Name.Split(\""""\\"""")[-1] # strip computername\
        $originalDescription = (Get-LocalUser -Name $account).Description
        Set-LocalUser -Name $account -Description \""""atr:$account;$originalDescription\"""".Substring(0,48) # Keep original name in description
        Rename-LocalUser -Name $account -NewName \""""HaHa_$x$y$z\"""" # Required due to length limitation
        Write-Host \""""Successfully Renamed $account Account on \"""" $Env:COMPUTERNAME
        }
    }}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19572,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:50.333

ProcessGuid: {f57bd86a-8b5a-658c-c401-000000000f00}

ProcessId: 9192

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {$x = Get-Random -Minimum 2 -Maximum 9999
$y = Get-Random -Minimum 2 -Maximum 9999
$z = Get-Random -Minimum 2 -Maximum 9999
$w = Get-Random -Minimum 2 -Maximum 9999
Write-Host HaHa_$x$y$z

$fmm = Get-LocalGroupMember -Group Administrators |?{ $_.ObjectClass -match \""""User\"""" -and $_.PrincipalSource -match \""""Local\""""} | Select Name

foreach($member in $fmm) {
    if($member -like \""""*Administrator*\"""") {
        $account = $member.Name.Split(\""""\\"""")[-1] # strip computername\
        $originalDescription = (Get-LocalUser -Name $account).Description
        Set-LocalUser -Name $account -Description \""""atr:$account;$originalDescription\"""".Substring(0,48) # Keep original name in description
        Rename-LocalUser -Name $account -NewName \""""HaHa_$x$y$z\"""" # Required due to length limitation
        Write-Host \""""Successfully Renamed $account Account on \"""" $Env:COMPUTERNAME
        }
    }}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b5a-658c-c401-000000000f00},3588,9192,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:38:50.3344857Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:50.333,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:50.3344857Z""/>
      <EventRecordID>19572</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:50.333</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b5a-658c-c401-000000000f00}</Data>
      <Data Name=""ProcessId"">9192</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {$x = Get-Random -Minimum 2 -Maximum 9999
$y = Get-Random -Minimum 2 -Maximum 9999
$z = Get-Random -Minimum 2 -Maximum 9999
$w = Get-Random -Minimum 2 -Maximum 9999
Write-Host HaHa_$x$y$z

$fmm = Get-LocalGroupMember -Group Administrators |?{ $_.ObjectClass -match \""""User\"""" -and $_.PrincipalSource -match \""""Local\""""} | Select Name

foreach($member in $fmm) {
    if($member -like \""""*Administrator*\"""") {
        $account = $member.Name.Split(\""""\\"""")[-1] # strip computername\
        $originalDescription = (Get-LocalUser -Name $account).Description
        Set-LocalUser -Name $account -Description \""""atr:$account;$originalDescription\"""".Substring(0,48) # Keep original name in description
        Rename-LocalUser -Name $account -NewName \""""HaHa_$x$y$z\"""" # Required due to length limitation
        Write-Host \""""Successfully Renamed $account Account on \"""" $Env:COMPUTERNAME
        }
    }}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:50.333

ProcessGuid: {f57bd86a-8b5a-658c-c401-000000000f00}

ProcessId: 9192

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {$x = Get-Random -Minimum 2 -Maximum 9999
$y = Get-Random -Minimum 2 -Maximum 9999
$z = Get-Random -Minimum 2 -Maximum 9999
$w = Get-Random -Minimum 2 -Maximum 9999
Write-Host HaHa_$x$y$z

$fmm = Get-LocalGroupMember -Group Administrators |?{ $_.ObjectClass -match \""""User\"""" -and $_.PrincipalSource -match \""""Local\""""} | Select Name

foreach($member in $fmm) {
    if($member -like \""""*Administrator*\"""") {
        $account = $member.Name.Split(\""""\\"""")[-1] # strip computername\
        $originalDescription = (Get-LocalUser -Name $account).Description
        Set-LocalUser -Name $account -Description \""""atr:$account;$originalDescription\"""".Substring(0,48) # Keep original name in description
        Rename-LocalUser -Name $account -NewName \""""HaHa_$x$y$z\"""" # Required due to length limitation
        Write-Host \""""Successfully Renamed $account Account on \"""" $Env:COMPUTERNAME
        }
    }}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""C:\Windows\system32\whoami.exe""",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\,whoami - displays logged on user information,1,19571,10.0.22621.1 (WinBuild.160101.0800),"MD5=E0F37DB23E4F3163159A815610DF8CF2,SHA256=574BC2A2995FE2B1F732CCD39F2D99460ACE980AF29EFDF1EB0D3E888BE7D6F0,IMPHASH=62935820E434AF643547B7F5F5BD0292",C:\Windows\System32\whoami.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:48.701

ProcessGuid: {f57bd86a-8b58-658c-c301-000000000f00}

ProcessId: 10140

Image: C:\Windows\System32\whoami.exe

FileVersion: 10.0.22621.1 (WinBuild.160101.0800)

Description: whoami - displays logged on user information

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: whoami.exe

CommandLine: ""C:\Windows\system32\whoami.exe""

CurrentDirectory: C:\Users\User\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=E0F37DB23E4F3163159A815610DF8CF2,SHA256=574BC2A2995FE2B1F732CCD39F2D99460ACE980AF29EFDF1EB0D3E888BE7D6F0,IMPHASH=62935820E434AF643547B7F5F5BD0292

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,whoami.exe,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b58-658c-c301-000000000f00},3588,10140,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:38:48.7043301Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:48.701,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:48.7043301Z""/>
      <EventRecordID>19571</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:48.701</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b58-658c-c301-000000000f00}</Data>
      <Data Name=""ProcessId"">10140</Data>
      <Data Name=""Image"">C:\Windows\System32\whoami.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.1 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">whoami - displays logged on user information</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">whoami.exe</Data>
      <Data Name=""CommandLine"">""C:\Windows\system32\whoami.exe""</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=E0F37DB23E4F3163159A815610DF8CF2,SHA256=574BC2A2995FE2B1F732CCD39F2D99460ACE980AF29EFDF1EB0D3E888BE7D6F0,IMPHASH=62935820E434AF643547B7F5F5BD0292</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:48.701

ProcessGuid: {f57bd86a-8b58-658c-c301-000000000f00}

ProcessId: 10140

Image: C:\Windows\System32\whoami.exe

FileVersion: 10.0.22621.1 (WinBuild.160101.0800)

Description: whoami - displays logged on user information

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: whoami.exe

CommandLine: ""C:\Windows\system32\whoami.exe""

CurrentDirectory: C:\Users\User\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=E0F37DB23E4F3163159A815610DF8CF2,SHA256=574BC2A2995FE2B1F732CCD39F2D99460ACE980AF29EFDF1EB0D3E888BE7D6F0,IMPHASH=62935820E434AF643547B7F5F5BD0292

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""C:\Windows\system32\HOSTNAME.EXE""",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\,Hostname APP,1,19570,10.0.22621.2506 (WinBuild.160101.0800),"MD5=E1EA6EFF1F45AA136A2A2E18EACC1F73,SHA256=4634E6685E402CC3CC8843589F4E8D8AC515F5F05D319E835A262B69B32BDB45,IMPHASH=23013EDF627646AB5226D15AC880BAD8",C:\Windows\System32\HOSTNAME.EXE,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:48.671

ProcessGuid: {f57bd86a-8b58-658c-c201-000000000f00}

ProcessId: 1640

Image: C:\Windows\System32\HOSTNAME.EXE

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Hostname APP

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: hostname.exe

CommandLine: ""C:\Windows\system32\HOSTNAME.EXE""

CurrentDirectory: C:\Users\User\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=E1EA6EFF1F45AA136A2A2E18EACC1F73,SHA256=4634E6685E402CC3CC8843589F4E8D8AC515F5F05D319E835A262B69B32BDB45,IMPHASH=23013EDF627646AB5226D15AC880BAD8

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,hostname.exe,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-8b58-658c-c201-000000000f00},3588,1640,Microsoft® Windows® Operating System,,,,"
      ",-,2023-12-27T20:38:48.6733666Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 20:38:48.671,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:48.6733666Z""/>
      <EventRecordID>19570</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 20:38:48.671</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-8b58-658c-c201-000000000f00}</Data>
      <Data Name=""ProcessId"">1640</Data>
      <Data Name=""Image"">C:\Windows\System32\HOSTNAME.EXE</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Hostname APP</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">hostname.exe</Data>
      <Data Name=""CommandLine"">""C:\Windows\system32\HOSTNAME.EXE""</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=E1EA6EFF1F45AA136A2A2E18EACC1F73,SHA256=4634E6685E402CC3CC8843589F4E8D8AC515F5F05D319E835A262B69B32BDB45,IMPHASH=23013EDF627646AB5226D15AC880BAD8</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 20:38:48.671

ProcessGuid: {f57bd86a-8b58-658c-c201-000000000f00}

ProcessId: 1640

Image: C:\Windows\System32\HOSTNAME.EXE

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Hostname APP

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: hostname.exe

CommandLine: ""C:\Windows\system32\HOSTNAME.EXE""

CurrentDirectory: C:\Users\User\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=E1EA6EFF1F45AA136A2A2E18EACC1F73,SHA256=4634E6685E402CC3CC8843589F4E8D8AC515F5F05D319E835A262B69B32BDB45,IMPHASH=23013EDF627646AB5226D15AC880BAD8

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,,,,22,19569,,,C:\Program Files (x86)\Microsoft\EdgeWebView\Application\120.0.2210.91\msedgewebview2.exe,,0x8000000000000000,Information,,,"Dns query:

RuleName: -

UtcTime: 2023-12-27 14:51:55.198

ProcessGuid: {f57bd86a-382d-658c-4e01-000000000f00}

ProcessId: 4456

QueryName: img-s-msn-com.akamaized.net

QueryStatus: 0

QueryResults: type: 5 a1834.dscg2.akamai.net;::ffff:96.17.178.193;::ffff:96.17.178.183;

Image: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\120.0.2210.91\msedgewebview2.exe

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-382d-658c-4e01-000000000f00},3588,4456,,img-s-msn-com.akamaized.net,type: 5 a1834.dscg2.akamai.net;::ffff:96.17.178.193;::ffff:96.17.178.183;,0,"
      ",-,2023-12-27T20:38:45.2377526Z,,Dns query (rule: DnsQuery),,5164,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 14:51:55.198,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>22</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>22</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T20:38:45.2377526Z""/>
      <EventRecordID>19569</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5164""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 14:51:55.198</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-382d-658c-4e01-000000000f00}</Data>
      <Data Name=""ProcessId"">4456</Data>
      <Data Name=""QueryName"">img-s-msn-com.akamaized.net</Data>
      <Data Name=""QueryStatus"">0</Data>
      <Data Name=""QueryResults"">type: 5 a1834.dscg2.akamai.net;::ffff:96.17.178.193;::ffff:96.17.178.183;</Data>
      <Data Name=""Image"">C:\Program Files (x86)\Microsoft\EdgeWebView\Application\120.0.2210.91\msedgewebview2.exe</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Dns query:

RuleName: -

UtcTime: 2023-12-27 14:51:55.198

ProcessGuid: {f57bd86a-382d-658c-4e01-000000000f00}

ProcessId: 4456

QueryName: img-s-msn-com.akamaized.net

QueryStatus: 0

QueryResults: type: 5 a1834.dscg2.akamai.net;::ffff:96.17.178.193;::ffff:96.17.178.183;

Image: C:\Program Files (x86)\Microsoft\EdgeWebView\Application\120.0.2210.91\msedgewebview2.exe

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>Dns query (rule: DnsQuery)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>

"
